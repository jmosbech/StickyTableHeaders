(function(a,b){"use strict";function f(c,f){var g=this;g.$el=a(c),g.el=c,g.$el.bind("destroyed",a.proxy(g.teardown,g)),g.$window=a(b),g.$clonedHeader=null,g.$originalHeader=null,g.isCloneVisible=!1,g.leftOffset=null,g.topOffset=null,g.init=function(){g.options=a.extend({},e,f),g.$el.each(function(){var b=a(this);b.css("padding",0),g.$originalHeader=a(g.options.headerSelector,this),g.$clonedHeader=g.$originalHeader.clone(),g.$clonedHeader.addClass("tableFloatingHeader"),g.$clonedHeader.css({position:"fixed",top:0,"z-index":1,display:"none"}),g.$originalHeader.addClass("tableFloatingHeaderOriginal"),g.$originalHeader.after(g.$clonedHeader),a(g.options.headerCellTag,g.$clonedHeader).on("click."+d,function(){var c=a(g.options.headerCellTag,g.$clonedHeader).index(this);a(g.options.headerCellTag,g.$originalHeader).eq(c).click()}),b.on("sortEnd."+d,g.updateWidth),g.$printStyle=a('<style type="text/css" media="print">.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{visibility:visible !important;}</style>'),a("head").append(g.$printStyle)}),g.updateWidth(),g.toggleHeaders(),g.bind()},g.destroy=function(){g.$el.unbind("destroyed",g.teardown),g.teardown()},g.teardown=function(){a.removeData(g.el,"plugin_"+d),g.unbind(),g.$clonedHeader.remove(),g.$originalHeader.removeClass("tableFloatingHeaderOriginal"),g.$originalHeader.css("visibility","visible"),g.$printStyle.remove(),g.el=null,g.$el=null},g.bind=function(){g.$window.on("scroll."+d,g.toggleHeaders),g.$window.on("resize."+d,g.toggleHeaders),g.$window.on("resize."+d,g.updateWidth)},g.unbind=function(){g.$window.off("."+d,g.toggleHeaders),g.$window.off("."+d,g.updateWidth),g.$el.off("."+d),g.$el.find("*").off("."+d)},g.toggleHeaders=function(){g.$el.each(function(){var b=a(this),c=isNaN(g.options.fixedOffset)?g.options.fixedOffset.height():g.options.fixedOffset,d=b.offset(),e=g.$window.scrollTop()+c,f=g.$window.scrollLeft();if(e>d.top&&d.top+b.height()-g.$clonedHeader.height()>e){var h=d.left-f;if(g.isCloneVisible&&h===g.leftOffset&&c===g.topOffset)return;g.$clonedHeader.css({top:c,"margin-top":0,left:h,display:"block"}),g.$originalHeader.css("visibility","hidden"),g.isCloneVisible=!0,g.leftOffset=h,g.topOffset=c}else g.isCloneVisible&&(g.$clonedHeader.css("display","none"),g.$originalHeader.css("visibility","visible"),g.isCloneVisible=!1)})},g.updateWidth=function(){a(g.options.headerCellTag,g.$clonedHeader).each(function(b){var c=a(this),d=a(g.options.headerCellTag,g.$originalHeader).eq(b);this.className=d.attr("class")||"",c.css({"min-width":d.width(),"max-width":d.width()})}),g.$clonedHeader.css("width",g.$originalHeader.width())},g.init()}var d="stickyTableHeaders",e={fixedOffset:0,headerSelector:"thead:first",headerCellTag:"th"};a.fn[d]=function(b){return this.each(function(){var c=a.data(this,"plugin_"+d);c?"string"==typeof b&&c[b].apply(c):"destroy"!==b&&a.data(this,"plugin_"+d,new f(this,b))})}})(jQuery,window);
